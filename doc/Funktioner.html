<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Funktioner
  
    &mdash; Documentation by YARD 0.9.34
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Funktioner";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/custom.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (F)</a> &raquo;
    
    
    <span class="title">Funktioner</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Funktioner
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>model.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>min funktions-modul, här har jag lagt alla hjälpfunktioner som mitt program (app.rb) använder sig av.</p>


  </div>
</div>
<div class="tags">
  



</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#admin_or_not-instance_method" title="#admin_or_not (instance method)">#<strong>admin_or_not</strong>  &#x21d2; boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>kontrollerar om den inloggade användaren är administratör.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#all_of-instance_method" title="#all_of (instance method)">#<strong>all_of</strong>(*strings)  &#x21d2; string </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>En funktion som sätter ihop flera routes, används i before routen.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#all_of2-instance_method" title="#all_of2 (instance method)">#<strong>all_of2</strong>(*strings2)  &#x21d2; string </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>En funktion som sätter ihop flera routes, används i before routen.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#anropa_db-instance_method" title="#anropa_db (instance method)">#<strong>anropa_db</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>anropar(initsierar databasen) detta krävs före varje db.execute, därför är det bra o ha det som en funktion.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#anv_delete-instance_method" title="#anv_delete (instance method)">#<strong>anv_delete</strong>(id)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Tar bort en användare från databasen.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_auth_user_or_admin-instance_method" title="#check_auth_user_or_admin (instance method)">#<strong>check_auth_user_or_admin</strong>(id)  &#x21d2; boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Kontrollerar om den inloggade användaren har redigeringsbehörighet till en annons.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_psw-instance_method" title="#check_psw (instance method)">#<strong>check_psw</strong>(password)  &#x21d2; boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Kontrollerar om användarens inmatade lösenord stämmer överens med det lösenord som finns sparat i databasen (i krypterad form).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_usr_auth-instance_method" title="#check_usr_auth (instance method)">#<strong>check_usr_auth</strong>(had, needed)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Kontrollerar om den inloggade användaren har samma behörighet som krävs för att få åtkomst till sidan  kontrollerar om needed är samma som had om inte den inloggade användern är rätt så kontrollerar den som den inloggade användaren är admin Om ingen av de stämmer: anropet avböjs och användaren får ett felmeddelande som säger att den inte har behörighet till sidan.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cooldown-instance_method" title="#cooldown (instance method)">#<strong>cooldown</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>en funktion som korntrollerar om användaren nyligen (inom de senaste 10 sekundrarna) har försök logga in (cooldown).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cooldown_note-instance_method" title="#cooldown_note (instance method)">#<strong>cooldown_note</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>felmeddelande då användaren försöker “brute-force:a” sig in på ett anväändarkonto.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_new_crypt_password-instance_method" title="#create_new_crypt_password (instance method)">#<strong>create_new_crypt_password</strong>(password)  &#x21d2; string </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>returnerar ett ett krypterat och saltat lösenord, med ett okrypterar lösenord som argument.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_image-instance_method" title="#delete_image (instance method)">#<strong>delete_image</strong>(id)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Tar bort en bild tillhörande en specifik annons med id “id” från public mappen.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#edit_usr_form_data-instance_method" title="#edit_usr_form_data (instance method)">#<strong>edit_usr_form_data</strong>(id)  &#x21d2; hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Hämtar all anvädardata från databasen som skall finnas med i det ifyllda formuläret på “redigera användare” sidan.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ej_inlogg_note-instance_method" title="#ej_inlogg_note (instance method)">#<strong>ej_inlogg_note</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>ger ett felmeddelande då användaren försöker göra något (spara annonser) som kräver att användaren är inloggad på ett konto.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hackerman-instance_method" title="#hackerman (instance method)">#<strong>hackerman</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>ger ett felmeddelande då någon försöker komma åt en route som de inte har behörighet till.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inloggad_anv_namn-instance_method" title="#inloggad_anv_namn (instance method)">#<strong>inloggad_anv_namn</strong>  &#x21d2; string </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>tar fram namnet på den användare som är inloggad för tillfället.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#no_of_likes-instance_method" title="#no_of_likes (instance method)">#<strong>no_of_likes</strong>(id)  &#x21d2; integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Räknar antalet användare som har sparat en specifik annons i relationstabellen.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#psw_check-instance_method" title="#psw_check (instance method)">#<strong>psw_check</strong>(gamla_password, psw_krypterad)  &#x21d2; boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Kontrollerar om ett angivet lösenord stämmer överens med det krypteade lösenordet som finns sparat i databasen.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rm_fav-instance_method" title="#rm_fav (instance method)">#<strong>rm_fav</strong>(annons_id, anv_id)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>tar bort en entry från relationstabellen i databasen.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#saved_by_user_or_not-instance_method" title="#saved_by_user_or_not (instance method)">#<strong>saved_by_user_or_not</strong>(user_name)  &#x21d2; boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Kontrollerar om lösenordet är upptaget eller inte.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#saveto_relation-instance_method" title="#saveto_relation (instance method)">#<strong>saveto_relation</strong>(anv_id, annons_id)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>lägger till en ny entry i relationstabellen mellan annonser och användare.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#savetodb_annonser-instance_method" title="#savetodb_annonser (instance method)">#<strong>savetodb_annonser</strong>(rubrik, pris, annonstext, user_id, kattegori, bild_filnamn)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sparar en ny annons i databasen.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#savetodb_anvandare-instance_method" title="#savetodb_anvandare (instance method)">#<strong>savetodb_anvandare</strong>(user_name, tel_nr, password_krypterat)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>läger till en ny användare i databasen.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_all_annons-instance_method" title="#select_all_annons (instance method)">#<strong>select_all_annons</strong>(id)  &#x21d2; hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Hämtar all data om en annons, hämtar även tilgängliga kattegorier, i de fall datan ska användas i ett redigeringsformulär.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_annons_data-instance_method" title="#select_annons_data (instance method)">#<strong>select_annons_data</strong>  &#x21d2; array </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Hämtar rubrik, id och pris från alla annonser.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_annonser-instance_method" title="#select_annonser (instance method)">#<strong>select_annonser</strong>  &#x21d2; array </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Hämtar all data om alla annonser Detta används på “visa annonser”-sidan där pris, rubrik, etc visas.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_kattegorier-instance_method" title="#select_kattegorier (instance method)">#<strong>select_kattegorier</strong>  &#x21d2; array </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Hämtar alla tillgängliga kattergorier, som användaren kan välja då de skapar eller redigerar en annons.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_kontakt_upg-instance_method" title="#select_kontakt_upg (instance method)">#<strong>select_kontakt_upg</strong>(id)  &#x21d2; string </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Hämtar e-postadressen till ägaren för en annons.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_owner_annonser-instance_method" title="#select_owner_annonser (instance method)">#<strong>select_owner_annonser</strong>  &#x21d2; array </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Hämtar all data om de annonser som den inloggade användaren äger.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_psw-instance_method" title="#select_psw (instance method)">#<strong>select_psw</strong>(id)  &#x21d2; string </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Tar fram och returnerar det krypterade lösenordet för en specifik användare.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_saved-instance_method" title="#select_saved (instance method)">#<strong>select_saved</strong>  &#x21d2; array </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Hämtar id på de annonser som den nuvarande användaren har sparat i sin favoritlista.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_user_login-instance_method" title="#select_user_login (instance method)">#<strong>select_user_login</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>En funktion som hämtar all tillgänglig användardata och ansetter detta till den globala variabeln result.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_user_saved_relation-instance_method" title="#select_user_saved_relation (instance method)">#<strong>select_user_saved_relation</strong>  &#x21d2; array </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>hämtar all annonsdata från de annonser som den inloggade användaren har sparat.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ta_veck_annons-instance_method" title="#ta_veck_annons (instance method)">#<strong>ta_veck_annons</strong>(id)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Tar bort en annons från databasen Tar även bort den relaterade datan ifrån relationstabellen där den borttagna annonsens id ingår.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_annonser-instance_method" title="#update_annonser (instance method)">#<strong>update_annonser</strong>(rubrik, pris, annonstext, kattegori, bild_filnamn, id)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Skriver förädringar till databasen efter att användaren har valt att ändra parametrar i en annons.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_user_data-instance_method" title="#update_user_data (instance method)">#<strong>update_user_data</strong>(user_name, tel_nr, id)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Skriver förändrngar av användardata till databasen då användaren väljer att redigera sin uppgifter.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_user_psw-instance_method" title="#update_user_psw (instance method)">#<strong>update_user_psw</strong>(user_name, tel_nr, password_krypterat, id)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Skriver förändrngar av användardata till databasen då användaren väljer att byta lösenord.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#utloggad-instance_method" title="#utloggad (instance method)">#<strong>utloggad</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Loggar ut från kontot.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#validate_email_note-instance_method" title="#validate_email_note (instance method)">#<strong>validate_email_note</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>ger ett felmeddelande då e-postadressen inte uppfyller valideringen.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#validate_email_password-instance_method" title="#validate_email_password (instance method)">#<strong>validate_email_password</strong>(email, password)  &#x21d2; boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>validerar lösenordet och e-postadressen,  Kontrollerar om e-postadressen innegåller ett “@” och att lösenordet består av minst tre tecken.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#validate_password_note-instance_method" title="#validate_password_note (instance method)">#<strong>validate_password_note</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>ger ett felmeddelande vilket säger att det angivan lösenordet är för kort.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="admin_or_not-instance_method">
  
    #<strong>admin_or_not</strong>  &#x21d2; <tt>boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>kontrollerar om den inloggade användaren är administratör.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>boolean</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


384
385
386</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 384</span>

<span class='kw'>def</span> <span class='id identifier rubyid_admin_or_not'>admin_or_not</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT DISTINCT admin FROM Anvandare WHERE id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:anv_id</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>admin</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='int'>1</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="all_of-instance_method">
  
    #<strong>all_of</strong>(*strings)  &#x21d2; <tt>string</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>En funktion som sätter ihop flera routes, används i before routen.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>,</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Flera strängar som input, dessa ska sättas ihop.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>, ett ihopkok av de strängar som havs som input.</p>
</div>
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


129
130
131</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 129</span>

<span class='kw'>def</span> <span class='id identifier rubyid_all_of'>all_of</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_strings'>strings</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_strings'>strings</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>|</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='regexp_end'>/</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="all_of2-instance_method">
  
    #<strong>all_of2</strong>(*strings2)  &#x21d2; <tt>string</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>En funktion som sätter ihop flera routes, används i before routen.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>,</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Flera strängar som input, dessa ska sättas ihop.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>, ett ihopkok av de strängar som havs som input.</p>
</div>
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


137
138
139
140</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 137</span>

<span class='kw'>def</span> <span class='id identifier rubyid_all_of2'>all_of2</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_strings2'>strings2</span><span class='rparen'>)</span>
    <span class='comment'>#p &quot;/(#{strings2.join(&quot;|&quot;)})/&quot;
</span>    <span class='kw'>return</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_strings2'>strings2</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>|</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='regexp_end'>/</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="anropa_db-instance_method">
  
    #<strong>anropa_db</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>anropar(initsierar databasen) detta krävs före varje db.execute, därför är det bra o ha det som en funktion.</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


7
8
9
10
11
12</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 7</span>

<span class='kw'>def</span> <span class='id identifier rubyid_anropa_db'>anropa_db</span><span class='lparen'>(</span><span class='rparen'>)</span>

    <span class='ivar'>@db</span> <span class='op'>=</span> <span class='const'>SQLite3</span><span class='op'>::</span><span class='const'>Database</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>db/AD_DATA.db</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_results_as_hash'>results_as_hash</span> <span class='op'>=</span> <span class='kw'>true</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="anv_delete-instance_method">
  
    #<strong>anv_delete</strong>(id)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Tar bort en användare från databasen. Tar även bort de annonser som ägas av användaren, samt datan i relationstabelen (sparade annonser) där användaren ingår.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>,</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>anv_id på den anvandare som ska tas bort.</p>
</div>
      
    </li>
  
</ul>




</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


103
104
105
106
107
108
109
110
111
112
113
114</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 103</span>

<span class='kw'>def</span> <span class='id identifier rubyid_anv_delete'>anv_delete</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>


    <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DELETE FROM Anvandare WHERE id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>

    <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DELETE FROM User_saved_relation WHERE anv_id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>

    <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DELETE FROM Annonser WHERE user_owner_id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>



<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check_auth_user_or_admin-instance_method">
  
    #<strong>check_auth_user_or_admin</strong>(id)  &#x21d2; <tt>boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Kontrollerar om den inloggade användaren har redigeringsbehörighet till en annons. Kontrollerar om den inloggade användaren är ägeren till annonsen, eller om den inloggade användaren är admin.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>,</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>användarid som krävs för återgärden.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>boolean</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


72
73
74
75
76
77
78
79
80
81
82
83
84
85
86</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 72</span>

<span class='kw'>def</span> <span class='id identifier rubyid_check_auth_user_or_admin'>check_auth_user_or_admin</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_anropa_db'><span class='object_link'><a href="#anropa_db-instance_method" title="Funktioner#anropa_db (method)">anropa_db</a></span></span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:anv_id</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT DISTINCT id FROM Anvandare WHERE admin = 1</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
        <span class='kw'>return</span> <span class='kw'>true</span>

    <span class='kw'>elsif</span> <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:anv_id</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT DISTINCT user_owner_id FROM Annonser WHERE id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>user_owner_id</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
        <span class='kw'>return</span> <span class='kw'>true</span>

    <span class='kw'>else</span> 
        <span class='kw'>return</span> <span class='kw'>false</span>

    <span class='kw'>end</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check_psw-instance_method">
  
    #<strong>check_psw</strong>(password)  &#x21d2; <tt>boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Kontrollerar om användarens inmatade lösenord stämmer överens med det lösenord som finns sparat i databasen (i krypterad form). @<a href="string">param</a> , lösenordet som användaren har angivit på inloggningssidan.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>boolean</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


151
152
153
154</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 151</span>

<span class='kw'>def</span> <span class='id identifier rubyid_check_psw'>check_psw</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_psw_krypterad'>psw_krypterad</span> <span class='op'>=</span> <span class='ivar'>@result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>losenord</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_password_okrypterat'>password_okrypterat</span><span class='op'>=</span><span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_psw_krypterad'>psw_krypterad</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='id identifier rubyid_password'>password</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check_usr_auth-instance_method">
  
    #<strong>check_usr_auth</strong>(had, needed)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Kontrollerar om den inloggade användaren har samma behörighet som krävs för att få åtkomst till sidan  kontrollerar om needed är samma som had om inte den inloggade användern är rätt så kontrollerar den som den inloggade användaren är admin Om ingen av de stämmer: anropet avböjs och användaren får ett felmeddelande som säger att den inte har behörighet till sidan</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>had</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>idt som använadren har</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>needed</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>idt krävs för att få åtkomst till sidan</p>
</div>
      
    </li>
  
</ul>


  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#check_auth_user_or_admin-instance_method" title="Funktioner#check_auth_user_or_admin (method)">#check_auth_user_or_admin</a></span></li>
    
      <li><span class='object_link'><a href="#hackerman-instance_method" title="Funktioner#hackerman (method)">#hackerman</a></span></li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 171</span>

<span class='kw'>def</span> <span class='id identifier rubyid_check_usr_auth'>check_usr_auth</span><span class='lparen'>(</span><span class='id identifier rubyid_had'>had</span><span class='comma'>,</span> <span class='id identifier rubyid_needed'>needed</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_had'>had</span> <span class='op'>==</span> <span class='id identifier rubyid_needed'>needed</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    
    <span class='kw'>elsif</span>
        
        <span class='kw'>if</span> <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:anv_id</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='kw'>nil</span>
            <span class='id identifier rubyid_check_auth_user_or_admin'><span class='object_link'><a href="#check_auth_user_or_admin-instance_method" title="Funktioner#check_auth_user_or_admin (method)">check_auth_user_or_admin</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_needed'>needed</span><span class='rparen'>)</span>
        <span class='kw'>end</span>

    <span class='kw'>else</span>

        <span class='id identifier rubyid_hackerman'><span class='object_link'><a href="#hackerman-instance_method" title="Funktioner#hackerman (method)">hackerman</a></span></span><span class='lparen'>(</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_redirect'>redirect</span> <span class='id identifier rubyid_back'>back</span>

    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cooldown-instance_method">
  
    #<strong>cooldown</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>en funktion som korntrollerar om användaren nyligen (inom de senaste 10 sekundrarna) har försök logga in (cooldown).  Om så är fallet avböjd inloggningsförsöket och användaren får ett felmeddelande</p>


  </div>
</div>
<div class="tags">
  

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#cooldown_note-instance_method" title="Funktioner#cooldown_note (method)">#cooldown_note</a></span></li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61
62
63
64
65
66</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 59</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cooldown'>cooldown</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:inlogg_tid</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='kw'>nil</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:inlogg_tid</span><span class='rbracket'>]</span><span class='op'>+</span><span class='int'>10</span> <span class='op'>&gt;</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
            <span class='id identifier rubyid_cooldown_note'><span class='object_link'><a href="#cooldown_note-instance_method" title="Funktioner#cooldown_note (method)">cooldown_note</a></span></span><span class='lparen'>(</span><span class='rparen'>)</span>
        <span class='kw'>end</span>

    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cooldown_note-instance_method">
  
    #<strong>cooldown_note</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>felmeddelande då användaren försöker “brute-force:a” sig in på ett anväändarkonto.</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48
49
50
51
52
53
54</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 46</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cooldown_note'>cooldown_note</span><span class='lparen'>(</span><span class='rparen'>)</span>


    <span class='id identifier rubyid_flash'>flash</span><span class='lbracket'>[</span><span class='symbol'>:notice</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Vänta 10 sekunder innan du försöker logga in igen.</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/anvandare/login/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>



<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_new_crypt_password-instance_method">
  
    #<strong>create_new_crypt_password</strong>(password)  &#x21d2; <tt>string</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>returnerar ett ett krypterat och saltat lösenord, med ett okrypterar lösenord som argument.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>password</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>ett okrypterat lösenord</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


407
408
409</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 407</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_new_crypt_password'>create_new_crypt_password</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_image-instance_method">
  
    #<strong>delete_image</strong>(id)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Tar bort en bild tillhörande en specifik annons med id “id” från public mappen. Frågar databasen vad filnamnet till annonsbilden är, därefter tar funktionen bort filen med det filnamnet.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>id nummret på den annons som vi önskar ta bort bilden.</p>
</div>
      
    </li>
  
</ul>




</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


258
259
260
261
262
263
264
265
266
267</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 258</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_image'>delete_image</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT DISTINCT bild FROM Annonser WHERE id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bild</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='kw'>nil</span> 
        <span class='id identifier rubyid_bild_filnamn'>bild_filnamn</span> <span class='op'>=</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT DISTINCT bild FROM Annonser WHERE id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bild</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>

        <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>./public/user_bilder/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_bild_filnamn'>bild_filnamn</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

    <span class='kw'>end</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="edit_usr_form_data-instance_method">
  
    #<strong>edit_usr_form_data</strong>(id)  &#x21d2; <tt>hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Hämtar all anvädardata från databasen som skall finnas med i det ifyllda formuläret på “redigera användare” sidan.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>,</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>id på den användaren vilken vi ska hämta datan.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>, hashad användardata från databasen.</p>
</div>
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160
161</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 159</span>

<span class='kw'>def</span> <span class='id identifier rubyid_edit_usr_form_data'>edit_usr_form_data</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT DISTINCT anv_namn, kontakt_upg FROM Anvandare WHERE id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ej_inlogg_note-instance_method">
  
    #<strong>ej_inlogg_note</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>ger ett felmeddelande då användaren försöker göra något (spara annonser) som kräver att användaren är inloggad på ett konto.</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


22
23
24
25
26
27</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 22</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ej_inlogg_note'>ej_inlogg_note</span><span class='lparen'>(</span><span class='rparen'>)</span>

    
    <span class='id identifier rubyid_flash'>flash</span><span class='lbracket'>[</span><span class='symbol'>:notice</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Du måste vara inloggad för att utföra den här återgärden</span><span class='tstring_end'>&quot;</span></span>
    
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="hackerman-instance_method">
  
    #<strong>hackerman</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>ger ett felmeddelande då någon försöker komma åt en route som de inte har behörighet till.</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


15
16
17
18
19</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 15</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hackerman'>hackerman</span><span class='lparen'>(</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_flash'>flash</span><span class='lbracket'>[</span><span class='symbol'>:notice</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hörredu Hackerman, Du har inte behörighet att utföra den här återgärden</span><span class='tstring_end'>&quot;</span></span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inloggad_anv_namn-instance_method">
  
    #<strong>inloggad_anv_namn</strong>  &#x21d2; <tt>string</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>tar fram namnet på den användare som är inloggad för tillfället.  namnet pressenteras sedan högst upp på sidan.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


192
193
194
195</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 192</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inloggad_anv_namn'>inloggad_anv_namn</span> 
    <span class='id identifier rubyid_anropa_db'><span class='object_link'><a href="#anropa_db-instance_method" title="Funktioner#anropa_db (method)">anropa_db</a></span></span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT DISTINCT anv_namn FROM Anvandare WHERE id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:anv_id</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>anv_namn</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="no_of_likes-instance_method">
  
    #<strong>no_of_likes</strong>(id)  &#x21d2; <tt>integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Räknar antalet användare som har sparat en specifik annons i relationstabellen. används i räknerverket på “annonse/show” där det står “sparad av XX andra användare”</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>för den annons på vilken vi vill räkna antalet likes.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


369
370
371</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 369</span>

<span class='kw'>def</span> <span class='id identifier rubyid_no_of_likes'>no_of_likes</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT COUNT (Annons_id) FROM User_saved_relation WHERE Annons_id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="psw_check-instance_method">
  
    #<strong>psw_check</strong>(gamla_password, psw_krypterad)  &#x21d2; <tt>boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Kontrollerar om ett angivet lösenord stämmer överens med det krypteade lösenordet som finns sparat i databasen</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>gamla_password</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>ett okrpterat lösenord som användaren matar in vid tex inloggning.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>psw_krypterad</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>ett kryperat lösenord från databasen som skall jämföras med det inmatade.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>boolean</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


415
416
417
418
419</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 415</span>

<span class='kw'>def</span> <span class='id identifier rubyid_psw_check'>psw_check</span><span class='lparen'>(</span><span class='id identifier rubyid_gamla_password'>gamla_password</span><span class='comma'>,</span> <span class='id identifier rubyid_psw_krypterad'>psw_krypterad</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_password_okrypterat'>password_okrypterat</span><span class='op'>=</span><span class='const'>BCrypt</span><span class='op'>::</span><span class='const'>Password</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_psw_krypterad'>psw_krypterad</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='id identifier rubyid_gamla_password'>gamla_password</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rm_fav-instance_method">
  
    #<strong>rm_fav</strong>(annons_id, anv_id)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>tar bort en entry från relationstabellen i databasen. när användaren väljer att ta bort en annons från favoritlistan tas många-många-relationen bort från relationstabellen.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>anv_id</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>id på anvaändaren som ska ta bort annonsen från sin favoritlista.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>annons_id</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>id på annonsen som ska tas bort från favoriter.</p>
</div>
      
    </li>
  
</ul>




</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


325
326
327</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 325</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rm_fav'>rm_fav</span><span class='lparen'>(</span><span class='id identifier rubyid_annons_id'>annons_id</span><span class='comma'>,</span> <span class='id identifier rubyid_anv_id'>anv_id</span><span class='rparen'>)</span>
    <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DELETE FROM User_saved_relation WHERE annons_id = ? AND anv_id =?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_annons_id'>annons_id</span><span class='comma'>,</span> <span class='id identifier rubyid_anv_id'>anv_id</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="saved_by_user_or_not-instance_method">
  
    #<strong>saved_by_user_or_not</strong>(user_name)  &#x21d2; <tt>boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Kontrollerar om lösenordet är upptaget eller inte.  Kollar hur många entries det finns i databasens “anvandare tabell” med samma användarnamn som det angivna i registreringsformuläret.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>user_name</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>anvädarnamnet som den nya användaren vill ta vid registrering.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>boolean</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


333
334
335</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 333</span>

<span class='kw'>def</span> <span class='id identifier rubyid_saved_by_user_or_not'>saved_by_user_or_not</span><span class='lparen'>(</span><span class='id identifier rubyid_user_name'>user_name</span><span class='rparen'>)</span>
<span class='kw'>return</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT COUNT (id) FROM Anvandare WHERE anv_namn = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_user_name'>user_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>COUNT (id)</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>==</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="saveto_relation-instance_method">
  
    #<strong>saveto_relation</strong>(anv_id, annons_id)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>lägger till en ny entry i relationstabellen mellan annonser och användare. Här sparas data då användaren trycker på “spara i favoritlistan”</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>anv_id</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>id på anvaändaren som sparar annonsen.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>annons_id</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>id på annonsen som ska läggas till i favoriter.</p>
</div>
      
    </li>
  
</ul>




</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


238
239
240
241
242</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 238</span>

<span class='kw'>def</span> <span class='id identifier rubyid_saveto_relation'>saveto_relation</span><span class='lparen'>(</span><span class='id identifier rubyid_anv_id'>anv_id</span><span class='comma'>,</span> <span class='id identifier rubyid_annons_id'>annons_id</span><span class='rparen'>)</span>

    <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>INSERT INTO User_saved_relation (anv_id, annons_id) VALUES (?,?)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_anv_id'>anv_id</span><span class='comma'>,</span> <span class='id identifier rubyid_annons_id'>annons_id</span><span class='rparen'>)</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="savetodb_annonser-instance_method">
  
    #<strong>savetodb_annonser</strong>(rubrik, pris, annonstext, user_id, kattegori, bild_filnamn)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sparar en ny annons i databasen</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>rubrik</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>annonsrubrik</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>pris</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>priset på varan</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>annonstext</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Beskrivning av varan</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>user_id</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>id på anvaändaren som äger annonsen.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>kattegori</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>id på den kattegori som annonsen tillhör</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>bild_filnamn</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>finamnet på annonsbildet som har sparats i public-mappen</p>
</div>
      
    </li>
  
</ul>




</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


229
230
231
232</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 229</span>

<span class='kw'>def</span> <span class='id identifier rubyid_savetodb_annonser'>savetodb_annonser</span><span class='lparen'>(</span><span class='id identifier rubyid_rubrik'>rubrik</span><span class='comma'>,</span> <span class='id identifier rubyid_pris'>pris</span><span class='comma'>,</span> <span class='id identifier rubyid_annonstext'>annonstext</span><span class='comma'>,</span> <span class='id identifier rubyid_user_id'>user_id</span><span class='comma'>,</span> <span class='id identifier rubyid_kattegori'>kattegori</span><span class='comma'>,</span> <span class='id identifier rubyid_bild_filnamn'>bild_filnamn</span><span class='rparen'>)</span>
    <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>INSERT INTO Annonser (rubrik, pris, annons_text, user_owner_id, kattegori_id, bild) VALUES (?,?,?,?,?,?)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_rubrik'>rubrik</span><span class='comma'>,</span> <span class='id identifier rubyid_pris'>pris</span><span class='comma'>,</span> <span class='id identifier rubyid_annonstext'>annonstext</span><span class='comma'>,</span> <span class='id identifier rubyid_user_id'>user_id</span><span class='comma'>,</span> <span class='id identifier rubyid_kattegori'>kattegori</span><span class='comma'>,</span> <span class='id identifier rubyid_bild_filnamn'>bild_filnamn</span><span class='rparen'>)</span>  
    
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="savetodb_anvandare-instance_method">
  
    #<strong>savetodb_anvandare</strong>(user_name, tel_nr, password_krypterat)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>läger till en ny användare i databasen. sparar användarnamn, kontaktuppgifter och lösenord som en ny entry i databasen.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>user_name</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>anvädarnamnet som den nya användaren skriver in.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>tel_nr</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>e-postadresson som den nya användaren skriver in.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>password_krypterat</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>lösenordet som den nya användaren skriver in.</p>
</div>
      
    </li>
  
</ul>




</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


249
250
251
252
253</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 249</span>

<span class='kw'>def</span> <span class='id identifier rubyid_savetodb_anvandare'>savetodb_anvandare</span><span class='lparen'>(</span><span class='id identifier rubyid_user_name'>user_name</span><span class='comma'>,</span> <span class='id identifier rubyid_tel_nr'>tel_nr</span><span class='comma'>,</span> <span class='id identifier rubyid_password_krypterat'>password_krypterat</span><span class='rparen'>)</span>

    <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>INSERT INTO Anvandare (anv_namn, kontakt_upg, losenord) VALUES (?,?,?)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_user_name'>user_name</span><span class='comma'>,</span> <span class='id identifier rubyid_tel_nr'>tel_nr</span><span class='comma'>,</span> <span class='id identifier rubyid_password_krypterat'>password_krypterat</span><span class='rparen'>)</span>
    
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="select_all_annons-instance_method">
  
    #<strong>select_all_annons</strong>(id)  &#x21d2; <tt>hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Hämtar all data om en annons, hämtar även tilgängliga kattegorier, i de fall datan ska användas i ett redigeringsformulär.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>hash</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


272
273
274
275
276
277</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 272</span>

<span class='kw'>def</span> <span class='id identifier rubyid_select_all_annons'>select_all_annons</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
    
    <span class='ivar'>@kattegorier</span> <span class='op'>=</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT * FROM Kattegorier</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

    <span class='kw'>return</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT * FROM Annonser WHERE id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="select_annons_data-instance_method">
  
    #<strong>select_annons_data</strong>  &#x21d2; <tt>array</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Hämtar rubrik, id och pris från alla annonser. pressenteras i “visa annonser” sidan</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>array</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


346
347
348</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 346</span>

<span class='kw'>def</span> <span class='id identifier rubyid_select_annons_data'>select_annons_data</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT DISTINCT rubrik, id, pris FROM Annonser</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="select_annonser-instance_method">
  
    #<strong>select_annonser</strong>  &#x21d2; <tt>array</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Hämtar all data om alla annonser Detta används på “visa annonser”-sidan där pris, rubrik, etc visas.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>array</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


391
392
393
394
395</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 391</span>

<span class='kw'>def</span> <span class='id identifier rubyid_select_annonser'>select_annonser</span><span class='lparen'>(</span><span class='rparen'>)</span>

    <span class='kw'>return</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT * FROM Annonser</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="select_kattegorier-instance_method">
  
    #<strong>select_kattegorier</strong>  &#x21d2; <tt>array</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Hämtar alla tillgängliga kattergorier, som användaren kan välja då de skapar eller redigerar en annons. Används i formulären för “new” eller “edit” på annonser.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>array</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


354
355
356</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 354</span>

<span class='kw'>def</span> <span class='id identifier rubyid_select_kattegorier'>select_kattegorier</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT * FROM Kattegorier</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="select_kontakt_upg-instance_method">
  
    #<strong>select_kontakt_upg</strong>(id)  &#x21d2; <tt>string</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Hämtar e-postadressen till ägaren för en annons.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id,</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>annons-id till den annons vi vill ha ägarens e-postadress.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


376
377
378
379
380</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 376</span>

<span class='kw'>def</span> <span class='id identifier rubyid_select_kontakt_upg'>select_kontakt_upg</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>

    <span class='kw'>return</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT kontakt_upg FROM Anvandare WHERE id IN (SELECT User_owner_id FROM Annonser WHERE id = ?)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>kontakt_upg</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="select_owner_annonser-instance_method">
  
    #<strong>select_owner_annonser</strong>  &#x21d2; <tt>array</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Hämtar all data om de annonser som den inloggade användaren äger. detta använs på “hantera mina annonser” - sidan.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>array</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


400
401
402</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 400</span>

<span class='kw'>def</span> <span class='id identifier rubyid_select_owner_annonser'>select_owner_annonser</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT * FROM Annonser WHERE user_owner_id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:anv_id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="select_psw-instance_method">
  
    #<strong>select_psw</strong>(id)  &#x21d2; <tt>string</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Tar fram och returnerar det krypterade lösenordet för en specifik användare</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>id på användaren</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


295
296
297
298
299
300</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 295</span>

<span class='kw'>def</span> <span class='id identifier rubyid_select_psw'>select_psw</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>

    <span class='kw'>return</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT DISTINCT Losenord FROM Anvandare WHERE id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>losenord</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>


<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="select_saved-instance_method">
  
    #<strong>select_saved</strong>  &#x21d2; <tt>array</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Hämtar id på de annonser som den nuvarande användaren har sparat i sin favoritlista. används på “sparade annonser” där användare n kan bläddra bland de annonser som den har sparat.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>array</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


361
362
363</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 361</span>

<span class='kw'>def</span> <span class='id identifier rubyid_select_saved'>select_saved</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Annons_id FROM User_saved_relation WHERE anv_id = </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:anv_id</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="select_user_login-instance_method">
  
    #<strong>select_user_login</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>En funktion som hämtar all tillgänglig användardata och ansetter detta till den globala variabeln result. Använs för att kontrollerar om inloggningsuppgifter stämmer vid inloggning.</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


144
145
146</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 144</span>

<span class='kw'>def</span> <span class='id identifier rubyid_select_user_login'>select_user_login</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='ivar'>@result</span> <span class='op'>=</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT * FROM Anvandare WHERE anv_namn = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='ivar'>@user_name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="select_user_saved_relation-instance_method">
  
    #<strong>select_user_saved_relation</strong>  &#x21d2; <tt>array</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>hämtar all annonsdata från de annonser som den inloggade användaren har sparat.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>array</tt>)</span>
      
      
      
    </li>
  
</ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


339
340
341</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 339</span>

<span class='kw'>def</span> <span class='id identifier rubyid_select_user_saved_relation'>select_user_saved_relation</span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT * FROM Annonser WHERE id IN (SELECT Annons_id FROM User_saved_relation WHERE anv_id = </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:anv_id</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ta_veck_annons-instance_method">
  
    #<strong>ta_veck_annons</strong>(id)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Tar bort en annons från databasen Tar även bort den relaterade datan ifrån relationstabellen där den borttagna annonsens id ingår.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>,</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>annonsid på den annons som ska tas bort.</p>
</div>
      
    </li>
  
</ul>




</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


92
93
94
95
96
97
98</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 92</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ta_veck_annons'>ta_veck_annons</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>

    <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DELETE FROM Annonser WHERE id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>

    <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DELETE FROM User_saved_relation WHERE annons_id = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_annonser-instance_method">
  
    #<strong>update_annonser</strong>(rubrik, pris, annonstext, kattegori, bild_filnamn, id)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Skriver förädringar till databasen efter att användaren har valt att ändra parametrar i en annons.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>rubrik</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>annonsrubrik</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>pris</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>priset på varan</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>annonstext</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Beskrivning av varan</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>id på annonsen som ska ändras.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>kattegori</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>id på den kattegori som annonsen tillhör</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>bild_filnamn</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>finamnet på annonsbildet som har sparats i public-mappen</p>
</div>
      
    </li>
  
</ul>




</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


286
287
288
289
290</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 286</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_annonser'>update_annonser</span><span class='lparen'>(</span><span class='id identifier rubyid_rubrik'>rubrik</span><span class='comma'>,</span> <span class='id identifier rubyid_pris'>pris</span><span class='comma'>,</span> <span class='id identifier rubyid_annonstext'>annonstext</span><span class='comma'>,</span> <span class='id identifier rubyid_kattegori'>kattegori</span><span class='comma'>,</span> <span class='id identifier rubyid_bild_filnamn'>bild_filnamn</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>

    <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UPDATE Annonser SET rubrik=?, pris=?, annons_text=?, kattegori_id=?, bild=? WHERE id=?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_rubrik'>rubrik</span><span class='comma'>,</span> <span class='id identifier rubyid_pris'>pris</span><span class='comma'>,</span> <span class='id identifier rubyid_annonstext'>annonstext</span><span class='comma'>,</span> <span class='id identifier rubyid_kattegori'>kattegori</span><span class='comma'>,</span> <span class='id identifier rubyid_bild_filnamn'>bild_filnamn</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>  
    
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_user_data-instance_method">
  
    #<strong>update_user_data</strong>(user_name, tel_nr, id)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Skriver förändrngar av användardata till databasen då användaren väljer att redigera sin uppgifter.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>user_name</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>anvädarnamnet som den nya användaren skriver in.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>tel_nr</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>e-postadresson som den nya användaren skriver in.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>id på användaren som vill redigera kontot.</p>
</div>
      
    </li>
  
</ul>




</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


306
307
308
309
310</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 306</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_user_data'>update_user_data</span><span class='lparen'>(</span><span class='id identifier rubyid_user_name'>user_name</span><span class='comma'>,</span> <span class='id identifier rubyid_tel_nr'>tel_nr</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>

    <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UPDATE Anvandare SET anv_namn=?, kontakt_upg=? WHERE id=?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_user_name'>user_name</span><span class='comma'>,</span> <span class='id identifier rubyid_tel_nr'>tel_nr</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_user_psw-instance_method">
  
    #<strong>update_user_psw</strong>(user_name, tel_nr, password_krypterat, id)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Skriver förändrngar av användardata till databasen då användaren väljer att byta lösenord.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>user_name</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>anvädarnamnet som den nya användaren skriver in.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>tel_nr</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>e-postadresson som den nya användaren skriver in.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>password_krypterat</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>lösenordet som den nya användaren skriver in.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>id på användaren som vill redigera kontor eller byta lösenord.</p>
</div>
      
    </li>
  
</ul>




</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


317
318
319</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 317</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_user_psw'>update_user_psw</span><span class='lparen'>(</span><span class='id identifier rubyid_user_name'>user_name</span><span class='comma'>,</span> <span class='id identifier rubyid_tel_nr'>tel_nr</span><span class='comma'>,</span> <span class='id identifier rubyid_password_krypterat'>password_krypterat</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span> 
    <span class='ivar'>@db</span><span class='period'>.</span><span class='id identifier rubyid_execute'>execute</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>UPDATE Anvandare SET anv_namn=?, kontakt_upg=?, losenord=? WHERE id=?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_user_name'>user_name</span><span class='comma'>,</span> <span class='id identifier rubyid_tel_nr'>tel_nr</span><span class='comma'>,</span> <span class='id identifier rubyid_password_krypterat'>password_krypterat</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>  
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="utloggad-instance_method">
  
    #<strong>utloggad</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Loggar ut från kontot. avslutar aktiva browser-sessions och ger ett bekräftelsemeddelande åt användaren där den har loggat ut.</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


118
119
120
121
122
123
124</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 118</span>

<span class='kw'>def</span> <span class='id identifier rubyid_utloggad'>utloggad</span><span class='lparen'>(</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_session'>session</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span>
    <span class='id identifier rubyid_flash'>flash</span><span class='lbracket'>[</span><span class='symbol'>:notice</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Du har loggat ut!</span><span class='tstring_end'>&quot;</span></span>


<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="validate_email_note-instance_method">
  
    #<strong>validate_email_note</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>ger ett felmeddelande då e-postadressen inte uppfyller valideringen.</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 38</span>

<span class='kw'>def</span> <span class='id identifier rubyid_validate_email_note'>validate_email_note</span><span class='lparen'>(</span><span class='rparen'>)</span>

    
    <span class='id identifier rubyid_flash'>flash</span><span class='lbracket'>[</span><span class='symbol'>:notice</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Felaktig e-post adress, ange en adress som innehåller @</span><span class='tstring_end'>&quot;</span></span>
    
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="validate_email_password-instance_method">
  
    #<strong>validate_email_password</strong>(email, password)  &#x21d2; <tt>boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>validerar lösenordet och e-postadressen,  Kontrollerar om e-postadressen innegåller ett “@” och att lösenordet består av minst tre tecken.  använder hjälpfunktioer för att skicka felmeddelanden om valideringen falerar på någon aspekt.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#validate_password_note-instance_method" title="Funktioner#validate_password_note (method)">#validate_password_note</a></span></li>
    
      <li><span class='object_link'><a href="#validate_email_note-instance_method" title="Funktioner#validate_email_note (method)">#validate_email_note</a></span></li>
    
  </ul>



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 203</span>

<span class='kw'>def</span> <span class='id identifier rubyid_validate_email_password'>validate_email_password</span><span class='lparen'>(</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&lt;</span> <span class='int'>3</span>
        <span class='id identifier rubyid_validate_password_note'><span class='object_link'><a href="#validate_password_note-instance_method" title="Funktioner#validate_password_note (method)">validate_password_note</a></span></span><span class='lparen'>(</span><span class='rparen'>)</span>
        <span class='kw'>return</span> <span class='kw'>false</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_email'>email</span><span class='period'>.</span><span class='id identifier rubyid_each_char'>each_char</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tecken'>tecken</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_tecken'>tecken</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@</span><span class='tstring_end'>&quot;</span></span>
            <span class='kw'>return</span> <span class='kw'>true</span>
        <span class='kw'>else</span> 
        <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_validate_email_note'><span class='object_link'><a href="#validate_email_note-instance_method" title="Funktioner#validate_email_note (method)">validate_email_note</a></span></span><span class='lparen'>(</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="validate_password_note-instance_method">
  
    #<strong>validate_password_note</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>ger ett felmeddelande vilket säger att det angivan lösenordet är för kort.</p>


  </div>
</div>
<div class="tags">
  



</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


30
31
32
33
34
35</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'model.rb', line 30</span>

<span class='kw'>def</span> <span class='id identifier rubyid_validate_password_note'>validate_password_note</span><span class='lparen'>(</span><span class='rparen'>)</span>

    
    <span class='id identifier rubyid_flash'>flash</span><span class='lbracket'>[</span><span class='symbol'>:notice</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Lösenordet är inte starkt nog, det måste innehålla minst 3 tecken</span><span class='tstring_end'>&quot;</span></span>
    
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue May  9 17:10:20 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.34 (ruby-3.1.2).
</div>

    </div>
  </body>
</html>